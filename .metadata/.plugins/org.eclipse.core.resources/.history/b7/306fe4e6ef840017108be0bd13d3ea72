package ifpb;

import java.sql.Connection;
import java.sql.SQLException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class App {
	public static void main(String[] args) throws SQLException {
		//
		final PgAppender appender = new PgAppender();
		//
		ExecutorService service = Executors.newFixedThreadPool(10);
		for (int i = 0; i < 2; i++){
			final String who = "Eu#" + i;
			final int initial = 750000*i; 
			Runnable runnable = new Runnable(){
				public void run() {
					try {
						final Connection conn = appender.connect();
						//execução SINCRONA (em 29431ms)
						long t0 = System.currentTimeMillis();
						appender.insert(conn, initial, who);
						long t1 = System.currentTimeMillis();
						//.................
						System.out.println(t1 - t0);
					} catch(SQLException e){
						e.printStackTrace();
					}
				};
			};
			service.submit(runnable);
		}
		service.shutdown();
	}
}
