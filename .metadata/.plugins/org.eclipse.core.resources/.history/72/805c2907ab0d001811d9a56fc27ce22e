package ag.protocol;

import java.util.Base64;

import ag.protocol.util.Util;

/**
 * Representa o frame de dados que ser√° enviado
 * ou recebido pelo cliente e servidor.
 * 
 * @author arigarcia
 *
 */
public class Frame{
	private boolean isInput;
	private boolean isText;
	private int length;
	private byte[] payload;
	
	private Frame() {
		isInput = true;//0
		isText = true;//1
		length = 1;
		payload = new byte[length];
	}
	
	public boolean isInput(){
		return isInput;
	}
	
	public boolean isText() {
		return isText;
	}
	
	public int getLength() {
		return length;
	}
	
	public byte[] getPayload() {
		return payload;
	}
	
	public void dump(){
		System.out.println("-------- FRAME ----------");
		System.out.println("IsInput:    \t" + isInput());
		System.out.println("IsText:     \t" + isText());
		System.out.println("Length:     \t" + getLength());
		System.out.println("Content-bin:  \t0x" + Util.byteArrayToHexString(frame.getPayload()));
		if (isText()){
			System.out.println("Content:    \t" + new String(getPayload()));
		} else {
			System.out.println("Content:    \t" + Base64.getEncoder().encodeToString(getPayload()));
		}
	}
	
	public void dumpAsStream(){
		System.out.println("-------- STREAM ----------");
		
	}
	
	private static Frame createInputOutputFrame(byte[] value, boolean isBinary, boolean isInput){
		//defining
		Frame tmp = new Frame();
		tmp.payload = value;
		tmp.length = value.length;
		tmp.isText = !isBinary;
		tmp.isInput = isInput;
		//result
		return tmp;
	}
	
	public static Frame createInputFrame(byte[] value, boolean isBinary){
		return createInputOutputFrame(value, isBinary, true);
	}
	
	public static Frame createOutputFrame(byte[] value, boolean isBinary){
		return createInputOutputFrame(value, isBinary, false);
	}
	
}
