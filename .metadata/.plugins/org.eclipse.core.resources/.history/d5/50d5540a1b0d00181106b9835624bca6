package ag.threads;

public class BlockingChannel {
	private int state = 0;
	private int identity = 0;
	private Object lock = new Object();
	
	public int lock() throws InterruptedException{
		synchronized (lock) {
			if (state == 1){
				lock.wait();
			} else {
				state = 1;
			}
			return identity++;
		}
	}
	
	public void unlock(){
		synchronized (lock) {
			lock.notify();
		}
	}
	
}
